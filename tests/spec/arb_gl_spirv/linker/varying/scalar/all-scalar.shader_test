[require]
SPIRV YES
GL >= 4.5
GLSL >= 4.50
GL_ARB_gl_spirv

[vertex shader spirv]
; Automatically generated from the GLSL by shader_test_spirv.py. DO NOT EDIT
; SPIR-V
; Version: 1.0
; Generator: Khronos Glslang Reference Front End; 6
; Bound: 43
; Schema: 0
               OpCapability Shader
               OpCapability Float64
          %1 = OpExtInstImport "GLSL.std.450"
               OpMemoryModel Logical GLSL450
               OpEntryPoint Vertex %main "main" %_ %piglit_vertex %d0 %d1 %i0 %i1 %u0 %u1 %f0 %f1 %gl_VertexID %gl_InstanceID
               OpSource GLSL 450
               OpName %main "main"
               OpName %gl_PerVertex "gl_PerVertex"
               OpMemberName %gl_PerVertex 0 "gl_Position"
               OpMemberName %gl_PerVertex 1 "gl_PointSize"
               OpMemberName %gl_PerVertex 2 "gl_ClipDistance"
               OpMemberName %gl_PerVertex 3 "gl_CullDistance"
               OpName %_ ""
               OpName %piglit_vertex "piglit_vertex"
               OpName %d0 "d0"
               OpName %d1 "d1"
               OpName %i0 "i0"
               OpName %i1 "i1"
               OpName %u0 "u0"
               OpName %u1 "u1"
               OpName %f0 "f0"
               OpName %f1 "f1"
               OpName %gl_VertexID "gl_VertexID"
               OpName %gl_InstanceID "gl_InstanceID"
               OpMemberDecorate %gl_PerVertex 0 BuiltIn Position
               OpMemberDecorate %gl_PerVertex 1 BuiltIn PointSize
               OpMemberDecorate %gl_PerVertex 2 BuiltIn ClipDistance
               OpMemberDecorate %gl_PerVertex 3 BuiltIn CullDistance
               OpDecorate %gl_PerVertex Block
               OpDecorate %piglit_vertex Location 0
               OpDecorate %d0 Flat
               OpDecorate %d0 Location 0
               OpDecorate %d1 Flat
               OpDecorate %d1 Location 1
               OpDecorate %i0 Flat
               OpDecorate %i0 Location 2
               OpDecorate %i1 Flat
               OpDecorate %i1 Location 3
               OpDecorate %u0 Flat
               OpDecorate %u0 Location 4
               OpDecorate %u1 Flat
               OpDecorate %u1 Location 5
               OpDecorate %f0 Location 6
               OpDecorate %f1 Location 7
               OpDecorate %gl_VertexID BuiltIn VertexId
               OpDecorate %gl_InstanceID BuiltIn InstanceId
       %void = OpTypeVoid
          %3 = OpTypeFunction %void
      %float = OpTypeFloat 32
    %v4float = OpTypeVector %float 4
       %uint = OpTypeInt 32 0
     %uint_1 = OpConstant %uint 1
%_arr_float_uint_1 = OpTypeArray %float %uint_1
%gl_PerVertex = OpTypeStruct %v4float %float %_arr_float_uint_1 %_arr_float_uint_1
%_ptr_Output_gl_PerVertex = OpTypePointer Output %gl_PerVertex
          %_ = OpVariable %_ptr_Output_gl_PerVertex Output
        %int = OpTypeInt 32 1
      %int_0 = OpConstant %int 0
%_ptr_Input_v4float = OpTypePointer Input %v4float
%piglit_vertex = OpVariable %_ptr_Input_v4float Input
%_ptr_Output_v4float = OpTypePointer Output %v4float
     %double = OpTypeFloat 64
%_ptr_Output_double = OpTypePointer Output %double
         %d0 = OpVariable %_ptr_Output_double Output
   %double_0 = OpConstant %double 0
         %d1 = OpVariable %_ptr_Output_double Output
   %double_1 = OpConstant %double 1
%_ptr_Output_int = OpTypePointer Output %int
         %i0 = OpVariable %_ptr_Output_int Output
         %i1 = OpVariable %_ptr_Output_int Output
      %int_1 = OpConstant %int 1
%_ptr_Output_uint = OpTypePointer Output %uint
         %u0 = OpVariable %_ptr_Output_uint Output
     %uint_0 = OpConstant %uint 0
         %u1 = OpVariable %_ptr_Output_uint Output
%_ptr_Output_float = OpTypePointer Output %float
         %f0 = OpVariable %_ptr_Output_float Output
    %float_0 = OpConstant %float 0
         %f1 = OpVariable %_ptr_Output_float Output
    %float_1 = OpConstant %float 1
%_ptr_Input_int = OpTypePointer Input %int
%gl_VertexID = OpVariable %_ptr_Input_int Input
%gl_InstanceID = OpVariable %_ptr_Input_int Input
       %main = OpFunction %void None %3
          %5 = OpLabel
         %18 = OpLoad %v4float %piglit_vertex
         %20 = OpAccessChain %_ptr_Output_v4float %_ %int_0
               OpStore %20 %18
               OpStore %d0 %double_0
               OpStore %d1 %double_1
               OpStore %i0 %int_0
               OpStore %i1 %int_1
               OpStore %u0 %uint_0
               OpStore %u1 %uint_1
               OpStore %f0 %float_0
               OpStore %f1 %float_1
               OpReturn
               OpFunctionEnd

[vertex shader]
#version 450 core

layout(location = 0) in vec4 piglit_vertex;

layout(location = 0) flat out double d0;
layout(location = 1) flat out double d1;
layout(location = 2) flat out int i0;
layout(location = 3) flat out int i1;
layout(location = 4) flat out uint u0;
layout(location = 5) flat out uint u1;
layout(location = 6) out float f0;
layout(location = 7) out float f1;

void main()
{
	gl_Position = piglit_vertex;


	d0 = 0.0;
	d1 = 1.0;
	i0 = 0;
	i1 = 1;

	u0 = 0;
	u1 = 1;

	f0 = 0.0;
	f1 = 1.0;
}

[fragment shader spirv]
; Automatically generated from the GLSL by shader_test_spirv.py. DO NOT EDIT
; SPIR-V
; Version: 1.0
; Generator: Khronos Glslang Reference Front End; 6
; Bound: 51
; Schema: 0
               OpCapability Shader
               OpCapability Float64
          %1 = OpExtInstImport "GLSL.std.450"
               OpMemoryModel Logical GLSL450
               OpEntryPoint Fragment %main "main" %d0 %d1 %i0 %i1 %u0 %u1 %f1 %out_color %f0
               OpExecutionMode %main OriginLowerLeft
               OpSource GLSL 450
               OpName %main "main"
               OpName %red "red"
               OpName %d0 "d0"
               OpName %d1 "d1"
               OpName %green "green"
               OpName %i0 "i0"
               OpName %i1 "i1"
               OpName %blue "blue"
               OpName %u0 "u0"
               OpName %u1 "u1"
               OpName %alpha "alpha"
               OpName %f1 "f1"
               OpName %out_color "out_color"
               OpName %f0 "f0"
               OpDecorate %d0 Flat
               OpDecorate %d0 Location 0
               OpDecorate %d1 Flat
               OpDecorate %d1 Location 1
               OpDecorate %i0 Flat
               OpDecorate %i0 Location 2
               OpDecorate %i1 Flat
               OpDecorate %i1 Location 3
               OpDecorate %u0 Flat
               OpDecorate %u0 Location 4
               OpDecorate %u1 Flat
               OpDecorate %u1 Location 5
               OpDecorate %f1 Location 7
               OpDecorate %out_color Location 0
               OpDecorate %f0 Location 6
       %void = OpTypeVoid
          %3 = OpTypeFunction %void
      %float = OpTypeFloat 32
%_ptr_Function_float = OpTypePointer Function %float
     %double = OpTypeFloat 64
%_ptr_Input_double = OpTypePointer Input %double
         %d0 = OpVariable %_ptr_Input_double Input
         %d1 = OpVariable %_ptr_Input_double Input
        %int = OpTypeInt 32 1
%_ptr_Input_int = OpTypePointer Input %int
         %i0 = OpVariable %_ptr_Input_int Input
         %i1 = OpVariable %_ptr_Input_int Input
       %uint = OpTypeInt 32 0
%_ptr_Input_uint = OpTypePointer Input %uint
         %u0 = OpVariable %_ptr_Input_uint Input
         %u1 = OpVariable %_ptr_Input_uint Input
%_ptr_Input_float = OpTypePointer Input %float
         %f1 = OpVariable %_ptr_Input_float Input
    %v4float = OpTypeVector %float 4
%_ptr_Output_v4float = OpTypePointer Output %v4float
  %out_color = OpVariable %_ptr_Output_v4float Output
         %f0 = OpVariable %_ptr_Input_float Input
       %main = OpFunction %void None %3
          %5 = OpLabel
        %red = OpVariable %_ptr_Function_float Function
      %green = OpVariable %_ptr_Function_float Function
       %blue = OpVariable %_ptr_Function_float Function
      %alpha = OpVariable %_ptr_Function_float Function
         %12 = OpLoad %double %d0
         %13 = OpFConvert %float %12
         %15 = OpLoad %double %d1
         %16 = OpFConvert %float %15
         %17 = OpFMul %float %13 %16
               OpStore %red %17
         %22 = OpLoad %int %i0
         %23 = OpConvertSToF %float %22
         %25 = OpLoad %int %i1
         %26 = OpConvertSToF %float %25
         %27 = OpFMul %float %23 %26
               OpStore %green %27
         %32 = OpLoad %uint %u0
         %33 = OpConvertUToF %float %32
         %35 = OpLoad %uint %u1
         %36 = OpConvertUToF %float %35
         %37 = OpFMul %float %33 %36
               OpStore %blue %37
         %41 = OpLoad %float %f1
               OpStore %alpha %41
         %45 = OpLoad %float %f1
         %46 = OpLoad %float %green
         %47 = OpLoad %float %blue
         %48 = OpLoad %float %alpha
         %49 = OpCompositeConstruct %v4float %45 %46 %47 %48
               OpStore %out_color %49
               OpReturn
               OpFunctionEnd

[fragment shader]
#version 450 core

layout(location = 0) out vec4 out_color;

layout(location = 0) flat in double d0;
layout(location = 1) flat in double d1;
layout(location = 2) flat in int i0;
layout(location = 3) flat in int i1;
layout(location = 4) flat in uint u0;
layout(location = 5) flat in uint u1;
layout(location = 6) in float f0;
layout(location = 7) in float f1;

void main()
{
	float red = float(d0) * float(d1);
	float green = float(i0) * float(i1);
	float blue = float(u0) * float(u1);
	float alpha = f1;

	out_color = vec4(f1, green, blue, alpha);
}

[test]
draw rect -1 -1 2 2
probe all rgba 1.0 0.0 0.0 1.0
